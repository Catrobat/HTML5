/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
(function(o,p,q){var s=o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.oRequestAnimationFrame||o.msRequestAnimationFrame||function(a){o.setTimeout(a,1000/60)};var t=(function(){var h={};var j=p.createElement('div').style;var m=(function(){var a=['t','webkitT','MozT','msT','OT'],transform,i=0,l=a.length;for(;i<l;i++){transform=a[i]+'ransform';if(transform in j)return a[i].substr(0,a[i].length-1)}return false})();function _prefixStyle(a){if(m===false)return false;if(m==='')return a;return m+a.charAt(0).toUpperCase()+a.substr(1)}h.getTime=Date.now||function getTime(){return new Date().getTime()};h.extend=function(a,b){for(var i in b){a[i]=b[i]}};h.addEvent=function(a,b,c,d){a.addEventListener(b,c,!!d)};h.removeEvent=function(a,b,c,d){a.removeEventListener(b,c,!!d)};h.prefixPointerEvent=function(a){return o.MSPointerEvent?'MSPointer'+a.charAt(9).toUpperCase()+a.substr(10):a};h.momentum=function(a,b,c,d,e,f){var g=a-b,speed=q.abs(g)/c,destination,duration;f=f===undefined?0.0006:f;destination=a+(speed*speed)/(2*f)*(g<0?-1:1);duration=speed/f;if(destination<d){destination=e?d-(e/2.5*(speed/8)):d;g=q.abs(destination-a);duration=g/speed}else if(destination>0){destination=e?e/2.5*(speed/8):0;g=q.abs(a)+destination;duration=g/speed}return{destination:q.round(destination),duration:duration}};var n=_prefixStyle('transform');h.extend(h,{hasTransform:n!==false,hasPerspective:_prefixStyle('perspective')in j,hasTouch:'ontouchstart'in o,hasPointer:o.PointerEvent||o.MSPointerEvent,hasTransition:_prefixStyle('transition')in j});h.isBadAndroid=/Android /.test(o.navigator.appVersion)&&!(/Chrome\/\d/.test(o.navigator.appVersion));h.extend(h.style={},{transform:n,transitionTimingFunction:_prefixStyle('transitionTimingFunction'),transitionDuration:_prefixStyle('transitionDuration'),transitionDelay:_prefixStyle('transitionDelay'),transformOrigin:_prefixStyle('transformOrigin')});h.hasClass=function(e,c){var a=new RegExp("(^|\\s)"+c+"(\\s|$)");return a.test(e.className)};h.addClass=function(e,c){if(h.hasClass(e,c)){return}var a=e.className.split(' ');a.push(c);e.className=a.join(' ')};h.removeClass=function(e,c){if(!h.hasClass(e,c)){return}var a=new RegExp("(^|\\s)"+c+"(\\s|$)",'g');e.className=e.className.replace(a,' ')};h.offset=function(a){var b=-a.offsetLeft,top=-a.offsetTop;while(a=a.offsetParent){b-=a.offsetLeft;top-=a.offsetTop}return{left:b,top:top}};h.preventDefaultException=function(a,b){var c=a.target;for(var i=0,l=b.length;i<l;i++){if((b[i].tagNames).test(c.tagName)&&(!b[i].eventNames||(b[i].eventNames).test(a.type)))return true}return false};h.extend(h.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});h.extend(h.ease={},{quadratic:{style:'cubic-bezier(0.25, 0.46, 0.45, 0.94)',fn:function(k){return k*(2-k)}},circular:{style:'cubic-bezier(0.1, 0.57, 0.1, 1)',fn:function(k){return q.sqrt(1-(--k*k))}},back:{style:'cubic-bezier(0.175, 0.885, 0.32, 1.275)',fn:function(k){var b=4;return(k=k-1)*k*((b+1)*k+b)+1}},bounce:{style:'',fn:function(k){if((k/=1)<(1/2.75)){return 7.5625*k*k}else if(k<(2/2.75)){return 7.5625*(k-=(1.5/2.75))*k+0.75}else if(k<(2.5/2.75)){return 7.5625*(k-=(2.25/2.75))*k+0.9375}else{return 7.5625*(k-=(2.625/2.75))*k+0.984375}}},elastic:{style:'',fn:function(k){var f=0.22,e=0.4;if(k===0){return 0}if(k==1){return 1}return(e*q.pow(2,-10*k)*q.sin((k-f/4)*(2*q.PI)/f)+1)}}});h.tap=function(e,a){var b=p.createEvent('Event');b.initEvent(a,true,true);b.pageX=e.pageX;b.pageY=e.pageY;e.target.dispatchEvent(b)};h.click=function(e){var a=e.target,ev;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(a.tagName)){ev=p.createEvent('MouseEvents');ev.initMouseEvent('click',true,true,e.view,1,a.screenX,a.screenY,a.clientX,a.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);ev._constructed=true;a.dispatchEvent(ev)}};return h})();function IScroll(a,b){this.wrapper=typeof a=='string'?p.querySelector(a):a;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:'',preventDefault:true,preventDefaultExceptions:[{tagNames:/^(INPUT|TEXTAREA|BUTTON|SELECT|LABEL)$/,eventNames:undefined,},{tagNames:/^(IMG)$/,eventNames:/^(touchstart)$/,},],HWCompositing:true,useTransition:true,useTransform:true};for(var i in b){this.options[i]=b[i]}this.translateZ=this.options.HWCompositing&&t.hasPerspective?' translateZ(0)':'';this.options.useTransition=t.hasTransition&&this.options.useTransition;this.options.useTransform=t.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?'vertical':this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=='vertical'?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=='horizontal'?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=='string'?t.ease[this.options.bounceEasing]||t.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap='tap'}if(this.options.shrinkScrollbars=='scale'){this.options.useTransition=false}this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}IScroll.prototype={version:'5.1.3',_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators()}if(this.options.mouseWheel){this._initWheel()}if(this.options.snap){this._initSnap()}if(this.options.keyBindings){this._initKeys()}},destroy:function(){this._initEvents(true);this._execEvent('destroy')},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent('scrollEnd')}},_start:function(e){if(t.eventType[e.type]!=1){if(e.button!==0){return}}if(!this.enabled||(this.initiated&&t.eventType[e.type]!==this.initiated)){return}if(this.options.preventDefault&&!t.isBadAndroid&&!t.preventDefaultException(e,this.options.preventDefaultExceptions)&&e.cancelable){e.preventDefault()}var a=e.touches?e.touches[0]:e,pos;this.initiated=t.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=t.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;pos=this.getComputedPosition();this._translate(q.round(pos.x),q.round(pos.y));this._execEvent('scrollEnd')}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent('scrollEnd')}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=a.pageX;this.pointY=a.pageY;this._execEvent('beforeScrollStart')},_move:function(e){if(!this.enabled||t.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&e.cancelable){e.preventDefault()}var a=e.touches?e.touches[0]:e,deltaX=a.pageX-this.pointX,deltaY=a.pageY-this.pointY,timestamp=t.getTime(),newX,newY,absDistX,absDistY;this.pointX=a.pageX;this.pointY=a.pageY;this.distX+=deltaX;this.distY+=deltaY;absDistX=q.abs(this.distX);absDistY=q.abs(this.distY);if(timestamp-this.endTime>300&&(absDistX<10&&absDistY<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(absDistX>absDistY+this.options.directionLockThreshold){this.directionLocked='h'}else if(absDistY>=absDistX+this.options.directionLockThreshold){this.directionLocked='v'}else{this.directionLocked='n'}}if(this.directionLocked=='h'){if(this.options.eventPassthrough=='vertical'){e.preventDefault()}else if(this.options.eventPassthrough=='horizontal'){this.initiated=false;return}deltaY=0}else if(this.directionLocked=='v'){if(this.options.eventPassthrough=='horizontal'){e.preventDefault()}else if(this.options.eventPassthrough=='vertical'){this.initiated=false;return}deltaX=0}deltaX=this.hasHorizontalScroll?deltaX:0;deltaY=this.hasVerticalScroll?deltaY:0;newX=this.x+deltaX;newY=this.y+deltaY;if(newX>0||newX<this.maxScrollX){newX=this.options.bounce?this.x+deltaX/3:newX>0?0:this.maxScrollX}if(newY>0||newY<this.maxScrollY){newY=this.options.bounce?this.y+deltaY/3:newY>0?0:this.maxScrollY}this.directionX=deltaX>0?-1:deltaX<0?1:0;this.directionY=deltaY>0?-1:deltaY<0?1:0;if(!this.moved){this._execEvent('scrollStart')}this.moved=true;this._translate(newX,newY);if(timestamp-this.startTime>300){this.startTime=timestamp;this.startX=this.x;this.startY=this.y}},_end:function(e){if(!this.enabled||t.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!t.preventDefaultException(e,this.options.preventDefaultExceptions)&&e.cancelable){e.preventDefault()}var a=e.changedTouches?e.changedTouches[0]:e,momentumX,momentumY,duration=t.getTime()-this.startTime,newX=q.round(this.x),newY=q.round(this.y),distanceX=q.abs(newX-this.startX),distanceY=q.abs(newY-this.startY),time=0,easing='';this.isInTransition=0;this.initiated=0;this.endTime=t.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(newX,newY);if(!this.moved){if(this.options.tap){t.tap(e,this.options.tap)}if(this.options.click){t.click(e)}this._execEvent('scrollCancel');return}if(this._events.flick&&duration<200&&distanceX<100&&distanceY<100){this._execEvent('flick');return}if(this.options.momentum&&duration<300){momentumX=this.hasHorizontalScroll?t.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0};momentumY=this.hasVerticalScroll?t.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0};newX=momentumX.destination;newY=momentumY.destination;time=q.max(momentumX.duration,momentumY.duration);this.isInTransition=1}if(this.options.snap){var b=this._nearestSnap(newX,newY);this.currentPage=b;time=this.options.snapSpeed||q.max(q.max(q.min(q.abs(newX-b.x),1000),q.min(q.abs(newY-b.y),1000)),300);newX=b.x;newY=b.y;this.directionX=0;this.directionY=0;easing=this.options.bounceEasing}if(newX!=this.x||newY!=this.y){if(newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY){easing=t.ease.quadratic}this.scrollTo(newX,newY,time,easing);return}this._execEvent('scrollEnd')},_resize:function(){var a=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){a.refresh()},this.options.resizePolling)},resetPosition:function(a){var x=this.x,y=this.y;a=a||0;if(!this.hasHorizontalScroll||this.x>0){x=0}else if(this.x<this.maxScrollX){x=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){y=0}else if(this.y<this.maxScrollY){y=this.maxScrollY}if(x==this.x&&y==this.y){return false}this.scrollTo(x,y,a,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var a=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=t.offset(this.wrapper);this._execEvent('refresh');this.resetPosition()},on:function(a,b){if(!this._events[a]){this._events[a]=[]}this._events[a].push(b)},off:function(a,b){if(!this._events[a]){return}var c=this._events[a].indexOf(b);if(c>-1){this._events[a].splice(c,1)}},_execEvent:function(a){if(!this._events[a]){return}var i=0,l=this._events[a].length;if(!l){return}for(;i<l;i++){this._events[a][i].apply(this,[].slice.call(arguments,1))}},scrollBy:function(x,y,a,b){x=this.x+x;y=this.y+y;a=a||0;this.scrollTo(x,y,a,b)},scrollTo:function(x,y,a,b){b=b||t.ease.circular;this.isInTransition=this.options.useTransition&&a>0;if(!a||(this.options.useTransition&&b.style)){this._transitionTimingFunction(b.style);this._transitionTime(a);this._translate(x,y)}else{this._animate(x,y,a,b.fn)}},scrollToElement:function(a,b,c,d,e){a=a.nodeType?a:this.scroller.querySelector(a);if(!a){return}var f=t.offset(a);f.left-=this.wrapperOffset.left;f.top-=this.wrapperOffset.top;if(c===true){c=q.round(a.offsetWidth/2-this.wrapper.offsetWidth/2)}if(d===true){d=q.round(a.offsetHeight/2-this.wrapper.offsetHeight/2)}f.left-=c||0;f.top-=d||0;f.left=f.left>0?0:f.left<this.maxScrollX?this.maxScrollX:f.left;f.top=f.top>0?0:f.top<this.maxScrollY?this.maxScrollY:f.top;b=b===undefined||b===null||b==='auto'?q.max(q.abs(this.x-f.left),q.abs(this.y-f.top)):b;this.scrollTo(f.left,f.top,b,e)},_transitionTime:function(a){a=a||0;this.scrollerStyle[t.style.transitionDuration]=a+'ms';if(!a&&t.isBadAndroid){this.scrollerStyle[t.style.transitionDuration]='0.001s'}if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTime(a)}}},_transitionTimingFunction:function(a){this.scrollerStyle[t.style.transitionTimingFunction]=a;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTimingFunction(a)}}},_translate:function(x,y){if(this.options.useTransform){this.scrollerStyle[t.style.transform]='translate('+x+'px,'+y+'px)'+this.translateZ}else{x=q.round(x);y=q.round(y);this.scrollerStyle.left=x+'px';this.scrollerStyle.top=y+'px'}this.x=x;this.y=y;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].updatePosition()}}},_initEvents:function(a){var b=a?t.removeEvent:t.addEvent,target=this.options.bindToWrapper?this.wrapper:o;b(o,'orientationchange',this);b(o,'resize',this);if(this.options.click){b(this.wrapper,'click',this,true)}if(!this.options.disableMouse){b(this.wrapper,'mousedown',this);b(target,'mousemove',this);b(target,'mousecancel',this);b(target,'mouseup',this)}if(t.hasPointer&&!this.options.disablePointer){b(this.wrapper,t.prefixPointerEvent('pointerdown'),this);b(target,t.prefixPointerEvent('pointermove'),this);b(target,t.prefixPointerEvent('pointercancel'),this);b(target,t.prefixPointerEvent('pointerup'),this)}if(t.hasTouch&&!this.options.disableTouch){b(this.wrapper,'touchstart',this);b(target,'touchmove',this);b(target,'touchcancel',this);b(target,'touchend',this)}b(this.scroller,'transitionend',this);b(this.scroller,'webkitTransitionEnd',this);b(this.scroller,'oTransitionEnd',this);b(this.scroller,'MSTransitionEnd',this)},getComputedPosition:function(){var a=o.getComputedStyle(this.scroller,null),x,y;if(this.options.useTransform){a=a[t.style.transform].split(')')[0].split(', ');x=+(a[12]||a[4]);y=+(a[13]||a[5])}else{x=+a.left.replace(/[^-\d.]/g,'');y=+a.top.replace(/[^-\d.]/g,'')}return{x:x,y:y}},_initIndicators:function(){var b=this.options.interactiveScrollbars,customStyle=typeof this.options.scrollbars!='string',indicators=[],indicator;var c=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){indicator={el:createDefaultScrollbar('v',b,this.options.scrollbars),interactive:b,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator)}if(this.options.scrollX){indicator={el:createDefaultScrollbar('h',b,this.options.scrollbars),interactive:b,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator)}}if(this.options.indicators){indicators=indicators.concat(this.options.indicators)}for(var i=indicators.length;i--;){this.indicators.push(new Indicator(this,indicators[i]))}function _indicatorsMap(a){for(var i=c.indicators.length;i--;){a.call(c.indicators[i])}}if(this.options.fadeScrollbars){this.on('scrollEnd',function(){_indicatorsMap(function(){this.fade()})});this.on('scrollCancel',function(){_indicatorsMap(function(){this.fade()})});this.on('scrollStart',function(){_indicatorsMap(function(){this.fade(1)})});this.on('beforeScrollStart',function(){_indicatorsMap(function(){this.fade(1,true)})})}this.on('refresh',function(){_indicatorsMap(function(){this.refresh()})});this.on('destroy',function(){_indicatorsMap(function(){this.destroy()});delete this.indicators})},_initWheel:function(){t.addEvent(this.wrapper,'wheel',this);t.addEvent(this.wrapper,'mousewheel',this);t.addEvent(this.wrapper,'DOMMouseScroll',this);this.on('destroy',function(){t.removeEvent(this.wrapper,'wheel',this);t.removeEvent(this.wrapper,'mousewheel',this);t.removeEvent(this.wrapper,'DOMMouseScroll',this)})},_wheel:function(e){if(!this.enabled){return}e.preventDefault();e.stopPropagation();var a,wheelDeltaY,newX,newY,that=this;if(this.wheelTimeout===undefined){that._execEvent('scrollStart')}clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){that._execEvent('scrollEnd');that.wheelTimeout=undefined},400);if('deltaX'in e){if(e.deltaMode===1){a=-e.deltaX*this.options.mouseWheelSpeed;wheelDeltaY=-e.deltaY*this.options.mouseWheelSpeed}else{a=-e.deltaX;wheelDeltaY=-e.deltaY}}else if('wheelDeltaX'in e){a=e.wheelDeltaX/120*this.options.mouseWheelSpeed;wheelDeltaY=e.wheelDeltaY/120*this.options.mouseWheelSpeed}else if('wheelDelta'in e){a=wheelDeltaY=e.wheelDelta/120*this.options.mouseWheelSpeed}else if('detail'in e){a=wheelDeltaY=-e.detail/3*this.options.mouseWheelSpeed}else{return}a*=this.options.invertWheelDirection;wheelDeltaY*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){a=wheelDeltaY;wheelDeltaY=0}if(this.options.snap){newX=this.currentPage.pageX;newY=this.currentPage.pageY;if(a>0){newX--}else if(a<0){newX++}if(wheelDeltaY>0){newY--}else if(wheelDeltaY<0){newY++}this.goToPage(newX,newY);return}newX=this.x+q.round(this.hasHorizontalScroll?a:0);newY=this.y+q.round(this.hasVerticalScroll?wheelDeltaY:0);if(newX>0){newX=0}else if(newX<this.maxScrollX){newX=this.maxScrollX}if(newY>0){newY=0}else if(newY<this.maxScrollY){newY=this.maxScrollY}this.scrollTo(newX,newY,0)},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=='string'){this.options.snap=this.scroller.querySelectorAll(this.options.snap)}this.on('refresh',function(){var i=0,l,m=0,n,cx,cy,x=0,y,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight,el;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return}if(this.options.snap===true){cx=q.round(stepX/2);cy=q.round(stepY/2);while(x>-this.scrollerWidth){this.pages[i]=[];l=0;y=0;while(y>-this.scrollerHeight){this.pages[i][l]={x:q.max(x,this.maxScrollX),y:q.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy};y-=stepY;l++}x-=stepX;i++}}else{el=this.options.snap;l=el.length;n=-1;for(;i<l;i++){if(i===0||el[i].offsetLeft<=el[i-1].offsetLeft){m=0;n++}if(!this.pages[m]){this.pages[m]=[]}x=q.max(-el[i].offsetLeft,this.maxScrollX);y=q.max(-el[i].offsetTop,this.maxScrollY);cx=x-q.round(el[i].offsetWidth/2);cy=y-q.round(el[i].offsetHeight/2);this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy};if(x>this.maxScrollX){m++}}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=q.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=q.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on('flick',function(){var a=this.options.snapSpeed||q.max(q.max(q.min(q.abs(this.x-this.startX),1000),q.min(q.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,a)})},_nearestSnap:function(x,y){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var i=0,l=this.pages.length,m=0;if(q.abs(x-this.absStartX)<this.snapThresholdX&&q.abs(y-this.absStartY)<this.snapThresholdY){return this.currentPage}if(x>0){x=0}else if(x<this.maxScrollX){x=this.maxScrollX}if(y>0){y=0}else if(y<this.maxScrollY){y=this.maxScrollY}for(;i<l;i++){if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break}}l=this.pages[i].length;for(;m<l;m++){if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break}}if(i==this.currentPage.pageX){i+=this.directionX;if(i<0){i=0}else if(i>=this.pages.length){i=this.pages.length-1}x=this.pages[i][0].x}if(m==this.currentPage.pageY){m+=this.directionY;if(m<0){m=0}else if(m>=this.pages[0].length){m=this.pages[0].length-1}y=this.pages[0][m].y}return{x:x,y:y,pageX:i,pageY:m}},goToPage:function(x,y,a,b){b=b||this.options.bounceEasing;if(x>=this.pages.length){x=this.pages.length-1}else if(x<0){x=0}if(y>=this.pages[x].length){y=this.pages[x].length-1}else if(y<0){y=0}var c=this.pages[x][y].x,posY=this.pages[x][y].y;a=a===undefined?this.options.snapSpeed||q.max(q.max(q.min(q.abs(c-this.x),1000),q.min(q.abs(posY-this.y),1000)),300):a;this.currentPage={x:c,y:posY,pageX:x,pageY:y};this.scrollTo(c,posY,a,b)},next:function(a,b){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++;if(x>=this.pages.length&&this.hasVerticalScroll){x=0;y++}this.goToPage(x,y,a,b)},prev:function(a,b){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--;if(x<0&&this.hasVerticalScroll){x=0;y--}this.goToPage(x,y,a,b)},_initKeys:function(e){var a={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var i;if(typeof this.options.keyBindings=='object'){for(i in this.options.keyBindings){if(typeof this.options.keyBindings[i]=='string'){this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0)}}}else{this.options.keyBindings={}}for(i in a){this.options.keyBindings[i]=this.options.keyBindings[i]||a[i]}t.addEvent(o,'keydown',this);this.on('destroy',function(){t.removeEvent(o,'keydown',this)})},_key:function(e){if(!this.enabled){return}var a=this.options.snap,newX=a?this.currentPage.pageX:this.x,newY=a?this.currentPage.pageY:this.y,now=t.getTime(),prevTime=this.keyTime||0,acceleration=0.250,pos;if(this.options.useTransition&&this.isInTransition){pos=this.getComputedPosition();this._translate(q.round(pos.x),q.round(pos.y));this.isInTransition=false}this.keyAcceleration=now-prevTime<200?q.min(this.keyAcceleration+acceleration,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX+=a?1:this.wrapperWidth}else{newY+=a?1:this.wrapperHeight}break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX-=a?1:this.wrapperWidth}else{newY-=a?1:this.wrapperHeight}break;case this.options.keyBindings.end:newX=a?this.pages.length-1:this.maxScrollX;newY=a?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newX=0;newY=0;break;case this.options.keyBindings.left:newX+=a?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=a?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=a?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=a?1:5+this.keyAcceleration>>0;break;default:return}if(a){this.goToPage(newX,newY);return}if(newX>0){newX=0;this.keyAcceleration=0}else if(newX<this.maxScrollX){newX=this.maxScrollX;this.keyAcceleration=0}if(newY>0){newY=0;this.keyAcceleration=0}else if(newY<this.maxScrollY){newY=this.maxScrollY;this.keyAcceleration=0}this.scrollTo(newX,newY,0);this.keyTime=now},_animate:function(b,c,d,e){var f=this,startX=this.x,startY=this.y,startTime=t.getTime(),destTime=startTime+d;function step(){var a=t.getTime(),newX,newY,easing;if(a>=destTime){f.isAnimating=false;f._translate(b,c);if(!f.resetPosition(f.options.bounceTime)){f._execEvent('scrollEnd')}return}a=(a-startTime)/d;easing=e(a);newX=(b-startX)*easing+startX;newY=(c-startY)*easing+startY;f._translate(newX,newY);if(f.isAnimating){s(step)}}this.isAnimating=true;step()},handleEvent:function(e){switch(e.type){case'touchstart':case'pointerdown':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'pointermove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'pointerup':case'MSPointerUp':case'mouseup':case'touchcancel':case'pointercancel':case'MSPointerCancel':case'mousecancel':this._end(e);break;case'orientationchange':case'resize':this._resize();break;case'transitionend':case'webkitTransitionEnd':case'oTransitionEnd':case'MSTransitionEnd':this._transitionEnd(e);break;case'wheel':case'DOMMouseScroll':case'mousewheel':this._wheel(e);break;case'keydown':this._key(e);break;case'click':if(!e._constructed){e.preventDefault();e.stopPropagation()}break}}};function createDefaultScrollbar(a,b,c){var d=p.createElement('div'),indicator=p.createElement('div');if(c===true){d.style.cssText='position:absolute;z-index:9999';indicator.style.cssText='-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px'}indicator.className='iScrollIndicator';if(a=='h'){if(c===true){d.style.cssText+=';height:7px;left:2px;right:2px;bottom:0';indicator.style.height='100%'}d.className='iScrollHorizontalScrollbar'}else{if(c===true){d.style.cssText+=';width:7px;bottom:2px;top:2px;right:1px';indicator.style.width='100%'}d.className='iScrollVerticalScrollbar'}d.style.cssText+=';overflow:hidden';if(!b){d.style.pointerEvents='none'}d.appendChild(indicator);return d}function Indicator(a,b){this.wrapper=typeof b.el=='string'?p.querySelector(b.el):b.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=a;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var i in b){this.options[i]=b[i]}this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){t.addEvent(this.indicator,'touchstart',this);t.addEvent(o,'touchend',this)}if(!this.options.disablePointer){t.addEvent(this.indicator,t.prefixPointerEvent('pointerdown'),this);t.addEvent(o,t.prefixPointerEvent('pointerup'),this)}if(!this.options.disableMouse){t.addEvent(this.indicator,'mousedown',this);t.addEvent(o,'mouseup',this)}}if(this.options.fade){this.wrapperStyle[t.style.transform]=this.scroller.translateZ;this.wrapperStyle[t.style.transitionDuration]=t.isBadAndroid?'0.001s':'0ms';this.wrapperStyle.opacity='0'}}Indicator.prototype={handleEvent:function(e){switch(e.type){case'touchstart':case'pointerdown':case'MSPointerDown':case'mousedown':this._start(e);break;case'touchmove':case'pointermove':case'MSPointerMove':case'mousemove':this._move(e);break;case'touchend':case'pointerup':case'MSPointerUp':case'mouseup':case'touchcancel':case'pointercancel':case'MSPointerCancel':case'mousecancel':this._end(e);break}},destroy:function(){if(this.options.interactive){t.removeEvent(this.indicator,'touchstart',this);t.removeEvent(this.indicator,t.prefixPointerEvent('pointerdown'),this);t.removeEvent(this.indicator,'mousedown',this);t.removeEvent(o,'touchmove',this);t.removeEvent(o,t.prefixPointerEvent('pointermove'),this);t.removeEvent(o,'mousemove',this);t.removeEvent(o,'touchend',this);t.removeEvent(o,t.prefixPointerEvent('pointerup'),this);t.removeEvent(o,'mouseup',this)}if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper)}},_start:function(e){var a=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=a.pageX;this.lastPointY=a.pageY;this.startTime=t.getTime();if(!this.options.disableTouch){t.addEvent(o,'touchmove',this)}if(!this.options.disablePointer){t.addEvent(o,t.prefixPointerEvent('pointermove'),this)}if(!this.options.disableMouse){t.addEvent(o,'mousemove',this)}this.scroller._execEvent('beforeScrollStart')},_move:function(e){var a=e.touches?e.touches[0]:e,deltaX,deltaY,newX,newY,timestamp=t.getTime();if(!this.moved){this.scroller._execEvent('scrollStart')}this.moved=true;deltaX=a.pageX-this.lastPointX;this.lastPointX=a.pageX;deltaY=a.pageY-this.lastPointY;this.lastPointY=a.pageY;newX=this.x+deltaX;newY=this.y+deltaY;this._pos(newX,newY);e.preventDefault();e.stopPropagation()},_end:function(e){if(!this.initiated){return}this.initiated=false;e.preventDefault();e.stopPropagation();t.removeEvent(o,'touchmove',this);t.removeEvent(o,t.prefixPointerEvent('pointermove'),this);t.removeEvent(o,'mousemove',this);if(this.scroller.options.snap){var a=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var b=this.options.snapSpeed||q.max(q.max(q.min(q.abs(this.scroller.x-a.x),1000),q.min(q.abs(this.scroller.y-a.y),1000)),300);if(this.scroller.x!=a.x||this.scroller.y!=a.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=a;this.scroller.scrollTo(a.x,a.y,b,this.scroller.options.bounceEasing)}}if(this.moved){this.scroller._execEvent('scrollEnd')}},transitionTime:function(a){a=a||0;this.indicatorStyle[t.style.transitionDuration]=a+'ms';if(!a&&t.isBadAndroid){this.indicatorStyle[t.style.transitionDuration]='0.001s'}},transitionTimingFunction:function(a){this.indicatorStyle[t.style.transitionTimingFunction]=a},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?'block':'none'}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?'block':'none'}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?'block':'none'}if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){t.addClass(this.wrapper,'iScrollBothScrollbars');t.removeClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='8px'}else{this.wrapper.style.bottom='8px'}}}else{t.removeClass(this.wrapper,'iScrollBothScrollbars');t.addClass(this.wrapper,'iScrollLoneScrollbar');if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right='2px'}else{this.wrapper.style.bottom='2px'}}}var r=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=q.max(q.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+'px'}else{this.indicatorWidth=this.indicator.clientWidth}this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=='clip'){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX}this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX/this.scroller.maxScrollX))}if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=q.max(q.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+'px'}else{this.indicatorHeight=this.indicator.clientHeight}this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=='clip'){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY}this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY/this.scroller.maxScrollY))}this.updatePosition()},updatePosition:function(){var x=this.options.listenX&&q.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&q.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(x<this.minBoundaryX){if(this.options.shrink=='scale'){this.width=q.max(this.indicatorWidth+x,8);this.indicatorStyle.width=this.width+'px'}x=this.minBoundaryX}else if(x>this.maxBoundaryX){if(this.options.shrink=='scale'){this.width=q.max(this.indicatorWidth-(x-this.maxPosX),8);this.indicatorStyle.width=this.width+'px';x=this.maxPosX+this.indicatorWidth-this.width}else{x=this.maxBoundaryX}}else if(this.options.shrink=='scale'&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+'px'}if(y<this.minBoundaryY){if(this.options.shrink=='scale'){this.height=q.max(this.indicatorHeight+y*3,8);this.indicatorStyle.height=this.height+'px'}y=this.minBoundaryY}else if(y>this.maxBoundaryY){if(this.options.shrink=='scale'){this.height=q.max(this.indicatorHeight-(y-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+'px';y=this.maxPosY+this.indicatorHeight-this.height}else{y=this.maxBoundaryY}}else if(this.options.shrink=='scale'&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+'px'}}this.x=x;this.y=y;if(this.scroller.options.useTransform){this.indicatorStyle[t.style.transform]='translate('+x+'px,'+y+'px)'+this.scroller.translateZ}else{this.indicatorStyle.left=x+'px';this.indicatorStyle.top=y+'px'}},_pos:function(x,y){if(x<0){x=0}else if(x>this.maxPosX){x=this.maxPosX}if(y<0){y=0}else if(y>this.maxPosY){y=this.maxPosY}x=this.options.listenX?q.round(x/this.sizeRatioX):this.scroller.x;y=this.options.listenY?q.round(y/this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(x,y)},fade:function(b,c){if(c&&!this.visible){return}clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var d=b?250:500,delay=b?0:300;b=b?'1':'0';this.wrapperStyle[t.style.transitionDuration]=d+'ms';this.fadeTimeout=setTimeout((function(a){this.wrapperStyle.opacity=a;this.visible=+a}).bind(this,b),delay)}};IScroll.utils=t;if(typeof module!='undefined'&&module.exports){module.exports=IScroll}else{o.IScroll=IScroll}})(window,document,Math);
